[2025-09-26 01:19:47,191] ERROR in photo_detection: Database save failed for extracted photos: (psycopg2.errors.UndefinedColumn) column "mime_type" of relation "photo" does not exist
LINE 1: ...e_path, thumbnail_path, file_size, width, height, mime_type,...
                                                             ^
[SQL: INSERT INTO photo (filename, original_name, file_path, thumbnail_path, file_size, width, height, mime_type, upload_source, created_at, updated_at, user_id, album_id, photo_date, date_text, date_circa, location_text, occasion, condition, photo_source, ... 1711 characters truncated ... 21, p22, p23, p24, p25, p26, sen_counter) ORDER BY sen_counter RETURNING photo.id, photo.id AS id__1]
[parameters: {'width__0': 321, 'user_id__0': 1, 'album_id__0': None, 'photo_source__0': None, 'date_circa__0': False, 'upload_source__0': 'photo_detection', 'processing_notes__0': 'Extracted via photo detection with 0.84 confidence', 'original_name__0': 'Extracted from GxmFlH9XYAEA2rG.jpg', 'edited_filename__0': None, 'filename__0': '6da8a839_photo_01_conf0.84.jpg', 'height__0': 524, 'back_text__0': None, 'mime_type__0': 'image/jpeg', 'condition__0': None, 'photo_date__0': None, 'updated_at__0': datetime.datetime(2025, 9, 26, 1, 19, 47, 187782), 'paired_photo_id__0': None, 'file_size__0': 55561, 'location_text__0': None, 'auto_enhanced__0': False, 'is_back_side__0': False, 'date_text__0': None, 'occasion__0': None, 'file_path__0': 'extracted_photos/6da8a839_photo_01_conf0.84.jpg', 'created_at__0': datetime.datetime(2025, 9, 26, 1, 19, 47, 187778), 'needs_restoration__0': False, 'thumbnail_path__0': None, 'width__1': 78, 'user_id__1': 1, 'album_id__1': None, 'photo_source__1': None, 'date_circa__1': False, 'upload_source__1': 'photo_detection', 'processing_notes__1': 'Extracted via photo detection with 0.31 confidence', 'original_name__1': 'Extracted from GxmFlH9XYAEA2rG.jpg', 'edited_filename__1': None, 'filename__1': '6da8a839_photo_02_conf0.31.jpg', 'height__1': 207, 'back_text__1': None, 'mime_type__1': 'image/jpeg', 'condition__1': None, 'photo_date__1': None, 'updated_at__1': datetime.datetime(2025, 9, 26, 1, 19, 47, 187787), 'paired_photo_id__1': None, 'file_size__1': 5211, 'location_text__1': None, 'auto_enhanced__1': False, 'is_back_side__1': False, 'date_text__1': None, 'occasion__1': None, 'file_path__1': 'extracted_photos/6da8a839_photo_02_conf0.31.jpg', 'created_at__1': datetime.datetime(2025, 9, 26, 1, 19, 47, 187786), 'needs_restoration__1': False, 'thumbnail_path__1': None}]
(Background on this error at: https://sqlalche.me/e/20/f405)
ERROR:photovault.routes.photo_detection:Database save failed for extracted photos: (psycopg2.errors.UndefinedColumn) column "mime_type" of relation "photo" does not exist
LINE 1: ...e_path, thumbnail_path, file_size, width, height, mime_type,...
                                                             ^
[SQL: INSERT INTO photo (filename, original_name, file_path, thumbnail_path, file_size, width, height, mime_type, upload_source, created_at, updated_at, user_id, album_id, photo_date, date_text, date_circa, location_text, occasion, condition, photo_source, ... 1711 characters truncated ... 21, p22, p23, p24, p25, p26, sen_counter) ORDER BY sen_counter RETURNING photo.id, photo.id AS id__1]
[parameters: {'width__0': 321, 'user_id__0': 1, 'album_id__0': None, 'photo_source__0': None, 'date_circa__0': False, 'upload_source__0': 'photo_detection', 'processing_notes__0': 'Extracted via photo detection with 0.84 confidence', 'original_name__0': 'Extracted from GxmFlH9XYAEA2rG.jpg', 'edited_filename__0': None, 'filename__0': '6da8a839_photo_01_conf0.84.jpg', 'height__0': 524, 'back_text__0': None, 'mime_type__0': 'image/jpeg', 'condition__0': None, 'photo_date__0': None, 'updated_at__0': datetime.datetime(2025, 9, 26, 1, 19, 47, 187782), 'paired_photo_id__0': None, 'file_size__0': 55561, 'location_text__0': None, 'auto_enhanced__0': False, 'is_back_side__0': False, 'date_text__0': None, 'occasion__0': None, 'file_path__0': 'extracted_photos/6da8a839_photo_01_conf0.84.jpg', 'created_at__0': datetime.datetime(2025, 9, 26, 1, 19, 47, 187778), 'needs_restoration__0': False, 'thumbnail_path__0': None, 'width__1': 78, 'user_id__1': 1, 'album_id__1': None, 'photo_source__1': None, 'date_circa__1': False, 'upload_source__1': 'photo_detection', 'processing_notes__1': 'Extracted via photo detection with 0.31 confidence', 'original_name__1': 'Extracted from GxmFlH9XYAEA2rG.jpg', 'edited_filename__1': None, 'filename__1': '6da8a839_photo_02_conf0.31.jpg', 'height__1': 207, 'back_text__1': None, 'mime_type__1': 'image/jpeg', 'condition__1': None, 'photo_date__1': None, 'updated_at__1': datetime.datetime(2025, 9, 26, 1, 19, 47, 187787), 'paired_photo_id__1': None, 'file_size__1': 5211, 'location_text__1': None, 'auto_enhanced__1': False, 'is_back_side__1': False, 'date_text__1': None, 'occasion__1': None, 'file_path__1': 'extracted_photos/6da8a839_photo_02_conf0.31.jpg', 'created_at__1': datetime.datetime(2025, 9, 26, 1, 19, 47, 187786), 'needs_restoration__1': False, 'thumbnail_path__1': None}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-09-26 01:19:47,191 INFO: Deleted local file: /app/photovault/uploads/1/6da8a839.jpg [in /app/photovault/utils/enhanced_file_handler.py:150]
[2025-09-26 01:19:47,191] INFO in enhanced_file_handler: Deleted local file: /app/photovault/uploads/1/6da8a839.jpg
INFO:photovault.utils.enhanced_file_handler:Deleted local file: /app/photovault/uploads/1/6da8a839.jpg
100.64.0.2 - - [26/Sep/2025:01:19:47 +0000] "POST /api/photo-detection/extract HTTP/1.1" 500 2585 "https://photoverone-production-c5dd.up.railway.app/photo-detection" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36 Edg/140.0.0.0"